# Experiment exp_20260207_090000 - Odds movement features: normalized deltas + volatility summaries

## Metadata
- run_id: exp_20260207_090000
- seed_id: EXP-014
- base_commit: b79d26f2f3f5ebc9e40657c4eae5b7c2389283c6
- head_commit: f8b5bc0003134f3350ccb306b6a462ed5d472cb1
- python_executable: C:\Users\yyosh\actions-runner\keiba\keiba\keiba\py64_analysis\.venv\Scripts\python.exe
- bootstrap_seed: 3931293281
- unit_of_resampling: day-block (YYYY-MM-DD)

## Hypothesis
Replacing the current odds movement feature representation with normalized movement deltas and simple time-series summary statistics (e.g., delta/volatility/count) will improve calibration (logloss) and backtest ROI versus the static-odds baseline.

## Experimental Design
- test_period: 2024-01-01 to 2024-12-31
- eval_command: `C:/Users/yyosh/actions-runner/keiba/keiba/keiba/py64_analysis/.venv/Scripts/python.exe py64_analysis/scripts/run_holdout.py --train-start 2020-01-01 --train-end 2022-12-31 --valid-start 2023-01-01 --valid-end 2023-12-31 --test-start 2024-01-01 --test-end 2024-12-31 --name exp_20260207_090000 --out-dir data/holdout_runs/exp_20260207_090000`
- config_used (variant): artifacts/experiments/exp_20260207_090000/config_used_variant.yaml
- config_used (baseline): artifacts/experiments/exp_20260207_090000/config_used_baseline.yaml

## Change Summary
Changed files: config/experiments/exp_20260207_090000.yaml, py64_analysis/src/keiba/config.py, py64_analysis/src/keiba/features/build_features.py, py64_analysis/src/keiba/modeling/train.py.

## Risk
- Experiment type: experiment
- risk_level: high
- max_diff_size: 200

## Metrics (required)
- ROI: 0.012554
- Total stake: 46200.000000
- n_bets: 117
- Test period: 2024-01-01 to 2024-12-31
- Max drawdown: 0.039860
- frac_days_any_bet: 0.679245
- frac_days_candidates_ge_n: 0.679245
- ROI definition: ROI = profit / stake, profit = return - stake.
- Rolling: no
- Design window: N/A
- Eval window: N/A
- Paired delta vs baseline: 0.340082
- Pooled vs step14 sign mismatch: no
- Preferred ROI for decisions: pooled

## Baseline (point estimates)
- baseline_ROI: -0.327528
- baseline_total_stake: 71200.000000
- baseline_n_bets: 172
- baseline_max_drawdown: 0.129467
- baseline_frac_days_any_bet: 0.773585
- baseline_frac_days_candidates_ge_n: 0.773585

## Paired Delta vs Baseline
- delta_ROI: 0.340082
- delta_max_drawdown: -0.089607

## Uncertainty (day-block bootstrap)
- ROI_variant_CI95: [-0.814461, 1.186038]
- ROI_baseline_CI95: [-0.904127, 0.447486]
- delta_ROI_CI95: [-0.566452, 1.425696]
- p_one_sided (P(delta<=0)): 0.238500
- bootstrap: {'B': 2000, 'seed': 3931293281, 'block_unit': 'day'}

## Robustness
### ROI by odds bucket
| odds_bucket | ROI | stake | bets | baseline_ROI | baseline_stake | baseline_bets |
|---|---:|---:|---:|---:|---:|---:|
| 10-20 | -1.000000 | 7700.000000 | 10 | -1.000000 | 17600.000000 | 33 |
| 20-30 | 1.079111 | 22500.000000 | 37 | 1.226590 | 17300.000000 | 27 |
| 30+ | -1.000000 | 16000.000000 | 70 | -0.742149 | 36300.000000 | 112 |

### ROI by month
| month | ROI | stake | bets | baseline_ROI | baseline_stake | baseline_bets |
|---|---:|---:|---:|---:|---:|---:|
| 2024-01 | -1.000000 | 3400.000000 | 8 | -1.000000 | 12600.000000 | 27 |
| 2024-02 | -1.000000 | 3800.000000 | 9 | -1.000000 | 4100.000000 | 15 |
| 2024-03 | 2.013514 | 3700.000000 | 10 | -1.000000 | 6800.000000 | 18 |
| 2024-04 | 1.737500 | 4800.000000 | 9 | 0.800000 | 5200.000000 | 14 |
| 2024-05 | -1.000000 | 6900.000000 | 13 | -1.000000 | 5600.000000 | 13 |
| 2024-06 | 1.435294 | 3400.000000 | 7 | -1.000000 | 3000.000000 | 14 |
| 2024-07 | -1.000000 | 4400.000000 | 11 | -1.000000 | 5100.000000 | 12 |
| 2024-08 | -1.000000 | 2500.000000 | 9 | -1.000000 | 5800.000000 | 10 |
| 2024-09 | 3.900000 | 2900.000000 | 10 | 3.709091 | 6600.000000 | 16 |
| 2024-10 | -1.000000 | 3600.000000 | 7 | -1.000000 | 6700.000000 | 9 |
| 2024-11 | -1.000000 | 3900.000000 | 14 | 1.480000 | 3000.000000 | 9 |
| 2024-12 | -1.000000 | 2900.000000 | 10 | -1.000000 | 6700.000000 | 15 |

## Artifacts
- metrics_json: artifacts/experiments/exp_20260207_090000/metrics.json
- baseline_metrics_json: artifacts/experiments/exp_20260207_090000/baseline_metrics.json
- per_bet_pnl: artifacts/experiments/exp_20260207_090000/per_bet_pnl.csv
- baseline_per_bet_pnl: artifacts/experiments/exp_20260207_090000/baseline_per_bet_pnl.csv
- summary_stats_json: artifacts/experiments/exp_20260207_090000/summary_stats.json
- report: artifacts/experiments/exp_20260207_090000/report/backtest.md
- config_used_variant: artifacts/experiments/exp_20260207_090000/config_used_variant.yaml
- config_used_baseline: artifacts/experiments/exp_20260207_090000/config_used_baseline.yaml

## Decision
- decision: needs-human
- rationale: Leakage safety check did not pass (heuristic).
- flags: CI_crosses_0, robustness_worse_majority, leakage_check_failed_or_unknown

## Notes
- leakage_check_pre_race_only: no
